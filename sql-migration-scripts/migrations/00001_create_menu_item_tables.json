{
    "Name": "Create menu item tables",
    "Reason for the migration": "Add table",
    "SQL script": "BEGIN TRANSACTION;\n    DO $$\n    BEGIN\n        IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'meal_types') THEN\n            CREATE TYPE meal_types AS ENUM('single', 'combo');\n        END IF;\n    END$$;\n\tCREATE TABLE IF NOT EXISTS menu_item (\n        id SERIAL,\n        name VARCHAR(255) NOT NULL,\n        description VARCHAR(255) NOT NULL,\n    \tphoto varchar(255) NOT NULL,\n        meal_type meal_types NOT NULL,\n        PRIMARY KEY (id)\n    );\n    CREATE TABLE IF NOT EXISTS price (\n        id SERIAL,\n\t\trate REAL NOT NULL,\n        menu_item_id INT NOT NULL,\n\t\tentry_time TIMESTAMP DEFAULT NOW(),\n\t\tentry_user VARCHAR(255) NOT NULL,\n\t\tupdate_time TIMESTAMP DEFAULT NOW(),\n\t\tupdate_user VARCHAR(255) NOT NULL,\n        FOREIGN KEY (menu_item_id) REFERENCES menu_item(id)\n        ON DELETE CASCADE,\n        PRIMARY KEY (id)\n    );\n    CREATE TABLE IF NOT EXISTS topping (\n        id SERIAL,\n        name VARCHAR(255) NOT NULL,\n        description VARCHAR(255) NOT NULL,\n    \tphoto varchar(255) NOT NULL,\n        PRIMARY KEY (id)\n    );\n    CREATE TABLE IF NOT EXISTS item_topping_pair (\n        item_id INT NOT NULL,\n        topping_id INT NOT NULL,\n        FOREIGN KEY (item_id) REFERENCES menu_item(id)\n        ON DELETE CASCADE,\n        FOREIGN KEY (topping_id) REFERENCES topping(id)\n        ON DELETE CASCADE,\n        PRIMARY KEY (item_id, topping_id)\n    );\nCOMMIT;\n\n",
    "Rollback script": "BEGIN TRANSACTION;\n\tDROP TABLE item_topping_pair;\n\tDROP TABLE topping;\n\tDROP TABLE price;\n\tDROP TABLE menu_item;\n\tDROP TYPE meal_types;\nCOMMIT;\n\n",
    "Comments": ""
}